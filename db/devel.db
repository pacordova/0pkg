autoconf = {
   url = "https://ftp.gnu.org/gnu/autoconf/autoconf-2.72.tar.xz",
   sha3 = "58d79b241a66db533747785182df3e49a61c9e5ed7508a002fd5bf033deaf7c8",
   build = "./configure",
};

automake = {
   url = "https://ftp.gnu.org/gnu/automake/automake-1.17.tar.xz",
   sha3 = "9ef65366aeef36107f79db7caeacb0829f328bc6456087d443361df3759851cf",
   build = "./configure",
};

libxml2 = {
   url = "https://download.gnome.org/sources/libxml2/2.13/libxml2-2.13.3.tar.xz",
   sha3 = "abba2c837356e1303c07b2703a95a1de5697f7e0c39d4e37b5e2132d96121de5",
   build = "./configure",
   flags = {
      "--with-{history=yes,legacy=yes,icu=no}",
      "PYTHON=/usr/bin/python3",
   }
};

libarchive = {
   url = "https://github.com/libarchive/libarchive/releases/download/v3.7.4/libarchive-3.7.4.tar.xz",
   sha3 = "27ee1cf7f44d7ba0a12998715d8dfb5aaca92c34279c34ee1ccf10325b19b098",
   build = "./configure",
   flags = { "--without-nettle" }
};

libev = {
   url = "http://dist.schmorp.de/libev/libev-4.33.tar.gz",
   sha3 = "ba1e921dd20ef633308f837e958e136b5ec80cd73683fd1bdb1ed48ceb59cf1b",
   build = "./configure",
};

nghttp2 = {
   url = "https://github.com/nghttp2/nghttp2/releases/download/v1.63.0/nghttp2-1.63.0.tar.xz",
   sha3 = "cbf7364a6ea68d6c9753f57154dc94dc07fd6160f8bf0c01a9470ad4a3403e99",
   build = "./configure",
   flags = { "--enable-lib-only", "--with-libev" }
};

libxslt = {
   url = "https://download.gnome.org/sources/libxslt/1.1/libxslt-1.1.42.tar.xz",
   sha3 = "89c1ef277e8a38b3825ede2c791e35e2495c600a9e94e2ca527663fb15cc815c",
   build = "./configure",
   flags = { "--without-python" }
};

libtool = {
   url = "https://ftp.gnu.org/gnu/libtool/libtool-2.4.7.tar.xz",
   sha3 = "a94fc179bf6832bc7e5974e4223d7cd16f6fd15664644ac77f769cafa280a7a4",
   build = "./configure",
   post = [[ rm -f $destdir/usr/lib64/libltdl.a ]]
};

libuv = {
   url = "https://dist.libuv.org/dist/v1.48.0/libuv-v1.48.0.tar.gz",
   sha3 = "68fb3f8b47090edd4b9f6d0a458f1f846ca9173404a12a9c3c5ff78b4190b314",
   prepare = [[ ./autogen.sh ]],
   build = "./configure",
};

libusb = {
   url = "https://github.com/libusb/libusb/releases/download/v1.0.27/libusb-1.0.27.tar.bz2",
   sha3 = "e79a5aa5c54bd32d07f1e0935b1b18c09fe7bfa6a202d5a1c218938764781164",
   build = "./configure",
};

libunistring = {
   url = "https://ftp.gnu.org/gnu/libunistring/libunistring-1.2.tar.xz",
   sha3 = "95472c6995afaa039064bab986637cb2825dd2cb20814db26fb365fd5cea9fd6",
   build = "./configure",
};

libidn2 = {
   url = "https://ftp.gnu.org/gnu/libidn/libidn2-2.3.7.tar.gz",
   sha3 = "889197927b322f26b41a4ba21e78f631cf0cdca8d8fcfa0f5ac0d4bdcd8278c8",
   build = "./configure",
   post = [[ rm -fr $destdir/usr/bin $destdir/usr/share/man/man1 ]]
};

--------------------------------------------------------------------------------

bc = {
   url = "https://github.com/gavinhoward/bc/releases/download/6.7.6/bc-6.7.6.tar.xz",
   sha3 = "1489f334be1908ec5727ddb52424a7dcb938b5e4bb615bab3cca4f0c9d72d0c0",
   build = "./configure",
   flags = {
      "--predefined-build-type=GNU",
      "--enable-readline",
      "--disable-{generated,problematic}-tests",
   },
};

check = {
   url = "https://github.com/libcheck/check/releases/download/0.15.2/check-0.15.2.tar.gz",
   sha3 = "bfb856a68c0ea4d930803f6bd16c1eed38910a231c9e0f0009e69310e35e7a5d",
   build = "./configure",
};

curl = {
   url = "https://curl.se/download/curl-8.9.1.tar.xz",
   sha3 = "d97e00e815d2249acca089b659e62ec4fac1653503464da5b46ea360f9032092",
   build = "./configure",
   flags = {
      "--enable-{ipv6,threaded-resolver,unix-sockets}",
      "--disable-{ares,ldap,ldaps,manual}",
      "--with-{openssl=yes,libidn2=yes,nghttp2=yes,libssh2=no}",
      "--with-ca-bundle=/etc/ssl/certs/ca-certificates.crt",
   }
};

cmake = {
   url = "https://cmake.org/files/v3.30/cmake-3.30.3.tar.gz",
   sha3 = "7c8d4532fc1951814e535335de94edd054abcb3c1e6efa3edd1b583d4ee5dd40",
   build = "./configure",
   flags = {
      "--mandir=/share/man",
      "--datadir=/share/cmake",
      "--docdir=/share/doc/cmake",
      "--parallel=$(getconf _NPROCESSORS_ONLN)",
      "--system-libs",
      "--no-system-{cppdap,jsoncpp,librhash}",
   },
   post = [[
      rm -fr $destdir/usr/share/cmake*/Help
      rm -fr $destdir/usr/share/bash-completion
   ]]
};

gettext = {
   url = "https://ftp.gnu.org/gnu/gettext/gettext-0.22.5.tar.xz",
   sha3 = "410646226a2f971e0789082352d6e270606af924c97305316d3bbd764fa9fbd5",
   build = "./configure",
   flags = { "--without-git" }
};

help2man = {
   url = "https://ftp.gnu.org/gnu/help2man/help2man-1.49.3.tar.xz",
   sha3 = "bc9a32dc38382300d57aa14e87cde7d218841190cb1745e65984a7ddc0bd8cb9",
   build = "./configure",
};

intltool = {
   url = "https://launchpad.net/intltool/trunk/0.51.0/+download/intltool-0.51.0.tar.gz",
   sha3 = "c215547f72957e1727976aeaa7156517fb005a5c8fe0df30e7f546c990ca8d19",
   build = "./configure",
   prepare = [[ sed -i 's:\\\${:\\\$\\{:' intltool-update.in ]]
};

itstool = {
   url = "https://files.itstool.org/itstool/itstool-2.0.7.tar.bz2",
   sha3 = "68d36ae4c43c1131cbaeaff67daac1fa236c44b58d0aff6bc5190ba5001b7046",
   build = "./configure",
};

meson = {
   url = "https://github.com/mesonbuild/meson/releases/download/1.5.1/meson-1.5.1.tar.gz",
   sha3 = "d0ebf1dce37be5e28c56ba155c5e0fbc2b4aa2958ede523e083b202b2c4b0759",
   build = "python-build",
};

nasm = {
   url = "https://www.nasm.us/pub/nasm/releasebuilds/2.16.03/nasm-2.16.03.tar.xz",
   sha3 = "3a7634350853231b03bb9fec8f23836a4bc7cfb9f8a48f2317555ac4aec98414",
   build = "./configure",
};

opendoas = {
   url = "https://github.com/Duncaen/OpenDoas/archive/v6.8.2/OpenDoas-6.8.2.tar.gz",
   sha3 = "de7bfb4797e216661db76043963090efc9e0e9e68ff420c352dbf71770c2b66c",
   build = "./configure",
   flags = {
      "--with-{shadow,timestamp}",
      "--without-pam"
   },
   post = [[
      mkdir -p $destdir/etc
      printf "permit persist :wheel\n" > $destdir/etc/doas.conf
      chmod 600 $destdir/etc/doas.conf
   ]]
};

optipng = {
   url = "https://prdownloads.sourceforge.net/optipng/optipng-0.7.8.tar.gz",
   sha3 = "4aa347bb09ec8421bf6cce96a3c9e12c0b47a100ece108c342a79a944d2b9027",
   build = "./configure",
   flags = {
      "--with-system-libs",
      "--mandir=/usr/share/man",
   }
};

samurai = {
   url = "https://github.com/michaelforney/samurai/releases/download/1.2/samurai-1.2.tar.gz",
   sha3 = "127ea48499f38f1a1c476957453ccca9419c8a4a938925e1361818102307375d",
   build = "make",
   flags = { "PREFIX=/usr" },
   post = [[ ln -sf samu $destdir/usr/bin/ninja ]]
};

texinfo = {
   url = "https://ftp.gnu.org/gnu/texinfo/texinfo-7.1.1.tar.xz",
   sha3 = "96cb51ac7c19265f6ddd0b6db5084d850f323f52068ef3a125a2cca50dd08f91",
   build = "./configure",
};

which = {
   url = "https://ftp.gnu.org/gnu/which/which-2.21.tar.gz",
   sha3 = "4a008a5fba90aa48ab099a000f60ce1067ef61f05ea0ace5e261066824f67792",
   build = "./configure",
};

--------------------------------------------------------------------------------

_glib2 = {
   url = "https://download.gnome.org/sources/glib/2.82/glib-2.82.0.tar.xz",
   sha3 = "bb8c6fd9c76cdb85e315c1dbeeb2c86412a70ba901345bdf6c2f6b5782989571",
   build = "meson",
   flags = { "-Dintrospection=disabled" }
};

gobject-introspection = {
   url = "https://download.gnome.org/sources/gobject-introspection/1.80/gobject-introspection-1.80.1.tar.xz",
   sha3 = "0aee06c2479fc07b9aa7092fecdf757f4efd7739c585b01b1733cd1b8d9ed034",
   build = "meson",
};

glib2 = {
   url = "https://download.gnome.org/sources/glib/2.82/glib-2.82.0.tar.xz",
   sha3 = "bb8c6fd9c76cdb85e315c1dbeeb2c86412a70ba901345bdf6c2f6b5782989571",
   build = "meson",
   flags = { "-Dintrospection=enabled" }
};

dbus-glib = {
   url = "https://dbus.freedesktop.org/releases/dbus-glib/dbus-glib-0.112.tar.gz",
   sha3 = "403eaea495309ea8260148a2cb945a1c08785b1c431bd867d1100b188b4efa41",
   build = "./configure",
};

json-glib = {
   url = "https://download.gnome.org/sources/json-glib/1.10/json-glib-1.10.0.tar.xz",
   sha3 = "63a0253ff4c71c1d49765cd773934af6982c6ce8cf051a4c63261a0105ae83d4",
   build = "meson",
   flags = { "-D{gtk_doc=disabled,nls=disabled,tests=false}" },
};

libgudev = {
   url = "https://download.gnome.org/sources/libgudev/238/libgudev-238.tar.xz",
   sha3 = "6500e55c1ceeaf85747d3eeaebd57e1cfc7fae4b5b4ceb7161cd8ab059d1863d",
   build = "meson",
};

upower = {
   url = "https://gitlab.freedesktop.org/upower/upower/-/archive/v1.90.5/upower-v1.90.5.tar.bz2",
   sha3 = "7b24ed91602d2b2cdc055e0193d44c17e171d7927d0575f876e43cd5adf026c1",
   build = "meson",
   flags = {
      "-Dsystemdsystemunitdir=no",
      "-Dudevrulesdir=/usr/lib64/udev/rules.d",
      "-Dgtk-doc=false",
      "-Dman=false"
   },
   prepare = [[ sed '/parse_version/d' -i src/linux/integration-test.py ]]
};

vala = {
   url = "https://download.gnome.org/sources/vala/0.56/vala-0.56.17.tar.xz",
   sha3 = "668609ee19af025e1778f93f81086e11d850354db8c4278a2ad2db944a951f9f",
   build = "./configure",
   flags = {
      "--enable-python3=yes",
      "--disable-python",
      "--disable-valadoc",
   },
   prepare = [[ sed -i '/gvc.h/a#define TRUE 1' libvaladoc/gvc-compat.c ]]
};
